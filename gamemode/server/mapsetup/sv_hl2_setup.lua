
//TEMPLATE
--[[
[""] = {
    ["checkpoints"] = {

    },
    
    
    ["checkpoint_spot"] = {
        
    },
	
	["checkpoint_angle"] = {
		[1] = Angle(0, 0, 0),
		[2] = Angle(0, 0, 0),
		[3] = Angle(0, 0, 0),
		[4] = Angle(0, 0, 0)
	},
    
    ["changelevels"] = {
        
    },
    
    ["checkpoint_functions"] = {

    },

    ["pushers"] = {
        
    }
	
	["pusher_spot"] = {

    }
}
--]]

HL2_LAMBDA_TRIGGERS = {
    ["d1_trainstation_05"] = {
        [1] = {
            [1] = Vector(-6512, -1086, 2),
            [2] = Vector(-6585, -1007, 105)
        }
    },

    ["d1_canals_01"] = {
        [1] = {
            [1] = Vector(803, -6250, 622),
            [2] = Vector(748, -6154, 513)
        },

        [2] = {
            [1] = Vector(589, -4978, 553),
            [2] = Vector(626, -4940, 512)
        }
    },

    ["d1_canals_01a"] = {
        [1] = {
            [1] = Vector(129, 6018, -88),
            [2] = Vector(71, 6094, 3)
        },
    },

    ["d1_canals_02"] = {
        [1] = {
            [1] = Vector(-181, -1008, -1069),
            [2] = Vector(-270, -945, -959)
        },
    },

    ["d1_canals_03"] = {
        [1] = {
            [1] = Vector(-190, -447, -1012),
            [2] = Vector(-48, -573, -878)
        },
    },

    ["d1_canals_05"] = {
        [1] = {
            [1] = Vector(4024, 4937, -126),
            [2] = Vector(4151, 4971, -28)
        },

        [2] = {
            [1] = Vector(4160, 4233, -319),
            [2] = Vector(4256, 4343, -173)
        }
    },

    ["d1_canals_06"] = {
        [1] = {
            [1] = Vector(7875, 9116, -125),
            [2] = Vector(7936, 9027, -234)
        },

        [2] = {
            [1] = Vector(4584, 5892, 97),
            [2] = Vector(4499, 6031, 172),
        },
        
        [3] = {
            [1] = Vector(-8082, 14007, -28),
            [2] = Vector(-8392, 13762, 92),
        },
    },

    ["d1_canals_07"] = {
        [1] = {
            [1] = Vector(-4549, -14917, -767),
            [2] = Vector(-4352, -14813, -894),
        }
    },

    ["d1_canals_08"] = {
        [1] = {
            [1] = Vector(-6918, 775, -427),
            [2] = Vector(-6773, 576, -604)
        },

        [2] = {
            [1] = Vector(10343, -7495, -24),
            [2] = Vector(10321, -7362, -445)
        }
    },

    ["d1_canals_09"] = {
        [1] = {
            [1] = Vector(7167, -9349, -315),
            [2] = Vector(6913, -9216, -173)
        }
    },

    ["d1_canals_10"] = {
        [1] = {
            [1] = Vector(12000, -1920, -191),
            [2] = Vector(11773, -1699, -25)
        },

        [2] = {
            [1] = Vector(11231, 457, -379),
            [2] = Vector(11129, 301, -263)
        }
    },
    
    ["d1_canals_12"] = {
        [1] = {
            [1] = Vector(551, 10888, 609),
            [2] = Vector(450, 11087, 500)
        }
    },

    ["d1_eli_01"] = {
        [1] = {
            [1] = Vector(88, 4337, -1234),
            [2] = Vector(197, 4490, -1406)
        }
    },

    ["d1_town_01"] = {
        [1] = {
            [1] = Vector(641, -1663, -3645),
            [2] = Vector(813, -1602, -3563)
        },

        [2] = {
            [1] = Vector(943, 1137, -3556),
            [2] = Vector(777, 1056, -3645)
        }
    },

    ["d1_town_01a"] = {
        [1] = {
            [1] = Vector(62, 271, -3248),
            [2] = Vector(125, 138, -3325)
        }
    },

    ["d1_town_05"] = {
        [1] = {
            [1] = Vector(-11388, 4304, 1119),
            [2] = Vector(-11437, 4271, 1040)
        }
    },

    ["d2_coast_01"] = {
        [1] = {
            [1] = Vector(-12764, 746, 1525),
            [2] = Vector(-13023, 607, 1680)
        }
    },

    ["d2_coast_03"] = {
        [1] = {
            [1] = Vector(-3177, -6113, 590),
            [2] = Vector(-3441, -6292, 715)
        }
    },

    ["d2_coast_04"] = {
        [1] = {
            [1] = Vector(2191, 6554, 1227),
            [2] = Vector(2233, 6717, 1172)
        }
    },

    ["d2_coast_05"] = {
        [1] = {
            [1] = Vector(-3186, 1423, 1097),
            [2] = Vector(-3562, 1278, 1225)
        }
    },

    ["d2_coast_07"] = {
        [1] = {
            [1] = Vector(1818, 9450, 1692),
            [2] = Vector(1661, 9216, 1817)
        }
    },

    ["d2_coast_09"] = {
        [1] = {
            [1] = Vector(11076, 8852, -27),
            [2] = Vector(11175, 8753, -43)
        }
    },

    ["d2_coast_11"] = {
        [1] = {
            [1] = Vector(3166, 956, 994),
            [2] = Vector(3435, 620, 817)
        }
    },

    ["d2_prison_02"] = {
        [1] = {
            [1] = Vector(-2256, 1727, 512),
            [2] = Vector(-2379, 1576, 662)
        }
    },
   
    ["d2_prison_03"] = {
        [1] = {
            [1] = Vector(-3594, 4139, 233),
            [2] = Vector(-3474, 3970, 130)
        }
    },

    ["d2_prison_05"] = {
        [1] = {
            [1] = Vector(-1344, 496, 385),
            [2] = Vector(-1470, 613, 516)
        }
    },
    ["d2_prison_05"] = {
        [1] = {
            [1] = Vector(-1344, 496, 385),
            [2] = Vector(-1470, 613, 516)
        }
    },
    
    ["d2_prison_06"] = {
        [1] = {
            [1] = Vector(692, -831, 2),
            [2] = Vector(782, -785, 127)
        }
    },

    ["d3_c17_02"] = {
        [1] = {
            [1] = Vector(-10158, -6277, 136),
            [2] = Vector(-10238, -6161, 66)
        }
    },
    
    ["d3_c17_04"] = {
        [1] = {
            [1] = Vector(-1025, -4980, 321),
            [2] = Vector(-1056, -4878, 428)
        }
    },

    ["d3_c17_05"] = {
        [1] = {
            [1] = Vector(2433, -4097, 257),
            [2] = Vector(2558, -4203, 129)
        }
    },

    ["d3_c17_06a"] = {
        [1] = {
            [1] = Vector(3576, -1729, -172),
            [2] = Vector(3831, -1949, -323)
        }
    },

    ["d3_c17_06b"] = {
        [1] = {
            [1] = Vector(4477, 2059, 503),
            [2] = Vector(4655, 1928, 386)
        },

        [2] = {
            [1] = Vector(5067, 1412, 67),
            [2] = Vector(4998, 1288, 250)
        }
    },

    ["d3_c17_08"] = {
        [1] = {
            [1] = Vector(1248, -925, -541),
            [2] = Vector()
        },

        [2] = {
            [1] = Vector(2575, -943, -526),
            [2] = Vector(2467, -1020, -413)
        },

        [3] = {
            [1] = Vector(1635, 663, 884),
            [2] = Vector(1758, 577, 769)
        },

        [4] = {
            [1] = Vector(-1213, -1804, -276),
            [2] = Vector(-962, -1885, -388)
        }
    },

    ["d3_c17_12b"] = {
        [1] = {
            [1] = Vector(-4248, 438, 226),
            [2] = Vector(-4340, 603, 99)
        }
    }

}

local HL2_TRIGGERS = {
    ["d1_trainstation_01"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-8883, -2159, -60),
                [2] = Vector(-9464, -2554, 143)
            },

            [2] = {
                [1] = Vector(-5413, -1987, 17),
                [2] = Vector(-5294, -1937, 135)
            },

            [3] = {
                [1] = Vector(-3612, -257, 94), 		
                [2] = Vector(-3440, -340, -28)
            },
            
            [4] = {
                [1] = Vector(-3459, -119, 72),
                [2] = Vector(-3410, -13, -29)
            }
        },

        ["checkpoint_functions"] = {
            [2] = function()
                timer.Simple(3, function()
                    for _, v in ipairs(player.GetAll()) do
                        v:SetFOV(0, 1)
                    end
                end)
            end
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-9294, -2445, 26),
            [2] = Vector(-5400, -2070, -18),
            [3] = Vector(-3419, -224, -21),
            [4] = Vector(-3549, -10, -19)
        },

        ["checkpoint_angle"] = {
            [1] = Angle(0, 15, 0),
            [2] = Angle(0, 0, 0),
            [3] = Angle(0, -30, 0),
            [4] = Angle(0, 40, 0)
        },

        ["changelevels"] = {
            [1] = Vector(-3130, -164, -61),
            [2] = Vector(-3073, -209, 59)
        }
    },

    ["d1_trainstation_02"] = {        
        ["changelevels"] = {
            [1] = Vector(-5293, -4599, 1),
            [2] = Vector(-5364, -4504, 130)
        },
    },

    ["d1_trainstation_03"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-4522, -4569, 386),
                [2] = Vector(-4594, -4654, 506),
            },

            [2] = {
                [1] = Vector(-4890, -4698, 513),
                [2] = Vector(-5031, -4730, 640)
            },
        },
        
        ["checkpoint_spot"] = {
            [1] = Vector(-4556, -4632, 389),
            [2] = Vector(-4990, -4788, 520)
        },
        
		["checkpoint_angle"] = {
            [1] = Angle(0, -180, 0),
            [2] = Angle(0, 190, 0)
        },
		
        ["changelevels"] = {
            [1] = Vector(-5206, -4756, 578),
            [2] = Vector(-5263, -4867, 688)
        },

        ["pushers"] = {
            [1] = {
                [1] = Vector(-5072, -4528, 422),
                [2] = Vector(-5133, -4595, 378)
            } ,
        },

        ["pusher_spot"] = {
            [1] = Vector(-5105, -4477, 334)
        }
    },

    ["d1_trainstation_04"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-4063, -3408, 654),
                [2] = Vector(-4095, -3517, 580)
            },

            [2] = {
                [1] = Vector(-6785, -4162, 521),
                [2] = Vector(-7254, -3956, 659)
            },

            [3] = {
                [1] = Vector(-7829, -4096, -254),
                [2] = Vector(-7796, -4156, -136)
            }
        },
        
        ["checkpoint_functions"] = {
            [3] = function()
                for _, v in ipairs(player.GetAll()) do	
                    v:GrantAchievement("Malcontent")
                end
            end
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-4148, -3457, 524),
            [2] = Vector(-7063, -4036, 522),
            [3] = Vector(-7872, -4126, -246)
        },
		
        ["checkpoint_angle"] = {
            [1] = Angle(0, 185, 0),
            [2] = Angle(0, 105, 0),
            [3] = Angle(0, 180, 0)
        },
        
        ["changelevels"] = {
            [1] = Vector(-8076, -4157, -253),
            [2] = Vector(-8028, -4095, -122)
        }
    },

    ["d1_trainstation_05"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-6409, -1195, 142),
                [2] = Vector(-6544, -1105, 1)
            },

            [2] = {
                [1] = Vector(-7065, -1298, 1),
                [2] = Vector(-7152, -1472, 125)
            },

            [3] = {
                [1] = Vector(-10383, -4692, 325),
                [2] = Vector(-10283, -4760, 461)
            },
            
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-6488, -1199, 8),
            [2] = Vector(-7167, -1377, 5),
            [3] = Vector(-10337, -4717, 328)
        },
		
        ["checkpoint_angle"] = {
            [1] = Angle(0, 230, 0),
            [2] = Angle(0, 100, 0),
            [3] = Angle(0, 210, 0)
        },
        
        ["changelevels"] = {
            [1] = Vector(-10685, -3639, 475),
            [2] = Vector(-10498, -3628, 321)
        }
    },

    ["d1_trainstation_06"] = {
        ["changelevels"] = {
            [1] = Vector(-8594, -575, -262),
            [2] = Vector(-8703, -513, -382)
        }
    },

    ["d1_canals_01"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(377, -3649, 375),
                [2] = Vector(129, -3616, 257)
            },

            [2] = {
                [1] = Vector(763, 2852, -94),
                [2] = Vector(638, 2785, 9)
            },            
        },
       
        ["checkpoint_spot"] = {
            [1] = Vector(111, -3459, 260),
            [2] = Vector(623, 2873, -88),
        },
		
        ["checkpoint_angle"] = {
            [1] = Angle(0, 0, 0),
            [2] = Angle(0, 20, 0)
        },
        
        ["changelevels"] = {
            [1] = Vector(689, 2859, -98), 
            [2] = Vector(764, 2977, 18)
        },

		["pushers"] = {
			[1] = {
				[1] = Vector(127, -6738, 701),
				[2] = Vector(66, -6785, 576)
			}
		},

		["pusher_spot"] = {
			[1] = Vector(-27, -6240, 587)
		}
    },

    ["d1_canals_01a"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-2760, 5232, 86),
                [2] = Vector(-2807, 5345, -42)
            }
        },
            
        ["checkpoint_spot"] = {
            [1] = Vector(-2821, 5296, -37)
        },
		
		["checkpoint_angle"] = {
            [1] = Angle(0, 180, 0)
        },
        
        ["changelevels"] = {
            [1] = Vector(-5758, 9295, -94), 		
            [2] = Vector(-5570, 9138, 160)
        }
    },

    ["d1_canals_02"] = {
        ["changelevels"] = {
            [1] = Vector(-416, 1702, -829),		
            [2] = Vector(-396, 1605, -725)
        },
        
        ["pushers"] = {
            [1] = {
                [1] = Vector(88, -56, -495),
                [2] = Vector(533, 100, -896)
            },
			[2] = {	--Prevent falling into seesaw at start
                [1] = Vector(2560, -2530, -750),
                [2] = Vector(3310, -2300, -450)
            },
        },

        ["pusher_spot"] = {
            [1] = Vector(440, -317, -793),
			[2] = Vector(2890, -2180, -640)
        }
    },

    ["d1_canals_03"] = {
        ["changelevels"] = {
            [1] = Vector(-3451, -123, -942), 	
            [2] = Vector(-3537, -33, -1070)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-1488, 480, -943),
                [2] = Vector(-1679, 630, -1038)
            },

            [2] = {
                [1] = Vector(-2034, -1011, -1230),
                [2] = Vector(-2213, -722, -1124)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-1579, 523, -1042),
            [2] = Vector(-2073, -885, -1223)
        },
		        
		["checkpoint_angle"] = {
            [1] = Angle(0, 270, 0),
            [2] = Angle(0, 180, 0)
        }
    },

    ["d1_canals_05"] = {
        ["changelevels"] = {
            [1] = Vector(-5251, -2561, -476), 	
            [2] = Vector(-5016, -2048, -256)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(4286, 1572, -343), 		
                [2] = Vector(4097, 1663, -472)
            },

            [2] = {
                [1] = Vector(6743, 1536, -446),
                [2] = Vector(6771, 1596, -347)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(4135, 1519, -455),
            [2] = Vector(6744, 1567, -439)
        },
			
		["checkpoint_angle"] = {
		[1] = Angle(0, 310, 0),
		[2] = Angle(0, 0, 0)
		}
    },

    ["d1_canals_06"] = {
        ["changelevels"] = {
            [1] = Vector(-1658, -3585, -468), 	
            [2] = Vector(-1046, -2491, -197)
        },
    },

    ["d1_canals_07"] = {
        ["changelevels"] = {
            [1] = Vector(-7215, -3843, -732),
            [2] = Vector(-7495, -4539, -1030)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(7583, 1658, -2545), 		
                [2] = Vector(7666, 1797, -83)
            },
			[2] = {	--added point before rpg trucks airboat section
                [1] = Vector(6600, 650, -660), 		
                [2] = Vector(7100, 1450, -140)
            },
        },
		
		["pushers"] = {
            [1] = {
                [1] = Vector(7584,1400,-159),
                [2] = Vector(7705,635,-579)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(9644,1367,-464)
        },

        ["checkpoint_spot"] = {
            [1] = Vector(7611, 1745, -245),
			[2] = Vector(6800, 1010, -420)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0),
			[2] = Angle(0, 180, 0)
		}
    },

    ["d1_canals_08"] = {
        ["changelevels"] = {
            [1] = Vector(-9138, 9429, -582),
            [2] = Vector(-8882, 8961, -216)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-777, -437, -487),
                [2] = Vector(-672, -544, -574)
            },

            [2] = {
                [1] = Vector(-2056, -3613, -352),
                [2] = Vector(-1730, -4486, -637)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-775, -559, -571),
            [2] = Vector(-1910, -4146, -629)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 270, 0),
			[2] = Angle(0, 180, 0)
		}
    },

    ["d1_canals_09"] = {
        ["changelevels"] = {
            [1] = Vector(-1782, -7391, -427), 	
            [2] = Vector(-1382, -7600, -140)
        }
    },

    ["d1_canals_10"] = {
        ["changelevels"] = {
            [1] = Vector(-13890, 316, -335),
            [2] = Vector(-13569, 608, -28)
        },
    },

    ["d1_canals_11"] = {
        ["changelevels"] = {
            [1] = Vector(-11332, -769, -950),
            [2] = Vector(-11705, -1019, -790)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(6181, 4735, -1004), 
                [2] = Vector(6422, 5060, -708)
            },

            [2] = {
                [1] = Vector(5418, 5055, -1021), 
                [2] = Vector(4842, 4698, -755)
            },

            [3] = {
                [1] = Vector(1792, -8100, -929),
                [2] = Vector(1917, -7171, -753)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(6415, 4996, -937),
            [2] = Vector(5703, 4901, -931),
            [3] = Vector(1852, -7389, -919)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 170, 0),
			[2] = Angle(0, 180, 0),
			[3] = Angle(0, 180, 0)
		},

        ["checkpoint_functions"] = {
            [1] = function()
				GAMEMODE:DisableVehicles(true)

                local tempAirboat = ents.Create(Airboat.Class)
                tempAirboat:SetModel(Airboat.Model)
                tempAirboat:SetPos(Vector(6340, 4855, -945))
                tempAirboat:SetAngles(Angle(0, 90, 0))
                tempAirboat:Activate()
                tempAirboat:Fire( "addoutput", "targetname airboat" );
                tempAirboat:Spawn()
            end,

            [2] = function()
                canSpawnGlobalGun = true
				GAMEMODE:DisableVehicles(false)
                BroadcastMessageToAll(HL2CR_GreenColour, translate.Get("Map_Enabled_Vehicles_Airboat_WithGun"))
            end
        },
    },

    ["d1_canals_12"] = {
        ["changelevels"] = {
            [1] = Vector(2623, -8575, 97),
            [2] = Vector(2263, -8499, 361)
        },
        
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-4583, 3482, 323),
                [2] = Vector(-4103, 3252, 463)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-4509, 3346, 332)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 270, 0)
		}
    },

    ["d1_canals_13"] = {
        ["changelevels"] = {
            [1] = Vector(-760, -3764, -225),
            [2] = Vector(-514, -3840, -381)
        },
		        
		["checkpoints"] = {
            [1] = {	--Added checkpoint after helicopter defeat
                [1] = Vector(4250, -2470, -150),
                [2] = Vector(5270, 1200, 150)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(4990, 1060, -135)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 240, 0)
		}
    },

    ["d1_eli_01"] = {
        ["changelevels"] = {
            [1] = Vector(-681, 1148, -2686),
            [2] = Vector(-511, 1091, -2574)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(29, 2799, -1277),
                [2] = Vector(-181, 2671, -1154)
            },

            [2] = {
                [1] = Vector(528, 1738, -1279),
                [2] = Vector(382, 1605, -1155)
            },

            [3] = {
                [1] = Vector(340, 1849, -2593),
                [2] = Vector(550, 1762, -2733)
            },

            [4] = {
                [1] = Vector(-488, 2189, -2734),
                [2] = Vector(-539, 2065, -2624)
            },
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-80, 2737, -1264),
            [2] = Vector(455, 1672, -1273),
            [3] = Vector(448, 1833, -2722),
            [4] = Vector(-703, 2119, -2729)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0),
			[2] = Angle(0, 270, 0),
			[3] = Angle(0, 90, 0),
			[4] = Angle(0, 270, 0)
		}
    },

    ["d1_eli_02"] = {
        ["changelevels"] = {
            [1] = Vector(-3559, 4081, -1664),
            [2] = Vector(-3412, 4015, -1529)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-677, 864, -2676),
                [2] = Vector(-519, 779, -2566)
            },

            [2] = {
                [1] = Vector(-846, 1391, -2686),
                [2] = Vector(-500, 1319, -2561)
            },

            [3] = {
                [1] = Vector(-1933, 2014, -2636),
                [2] = Vector(-1984, 1826, -2733)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-600, 750, -2676),
            [2] = Vector(-667, 1308, -2674),
            [3] = Vector(-2011, 1908, -2725)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 260, 0),
			[2] = Angle(0, 100, 0),
			[3] = Angle(0, 150, 0)
		}
    },

    ["d1_town_01"] = {
        ["changelevels"] = {
            [1] = Vector(246, 363, -3208),
            [2] = Vector(136, 296, -3326)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(1175, -341, -3389),
                [2] = Vector(1259, -401, -3515)
            },
        },

        ["checkpoint_spot"] = {
            [1] = Vector(1223, -361, -3507)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 90, 0)
		}
    },

    ["d1_town_01a"] = {
        ["changelevels"] = {
            [1] = Vector(-615, 653, -3310),
            [2] = Vector(-689, 766, -3438)
        }
    },

    ["d1_town_02"] = {
        ["changelevels"] = {
            [1] = Vector(-3588, -573, -3439),
            [2] = Vector(-3710, -478, -3582)
        },

        ["changelevels_special"] = {
            [1] = Vector(-5286, 2102, -3260),
            [2] = Vector(-5092, 1863, -3041)
        },

        ["checkpoints"] = {
            [1] = {		--Checkpoint for 2nd map run
                [1] = Vector(-4737, 952, -3085),
                [2] = Vector(-4531, 800, -3255)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-4809, 589, -3246)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 120, 0)
		},
        
        ["pushers"] = {		--Prevent skipping lift section
            [1] = {
                [1] = Vector(-3400, 370, -3180),
                [2] = Vector(-2650, 810, -3170)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(-2410, 640, -3250)
        }
    },

    ["d1_town_03"] = {
        ["changelevels"] = {
            [1] = Vector(-3722, -62, -3453),
            [2] = Vector(-3798, 9, -3337)
        },

        ["pushers"] = {
            [1] = {		--Anti shortcut
                [1] = Vector(-2361, -1211, -3436),
                [2] = Vector(-2563, -1586, -3232)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(-1994, -1424, -3645)
        }
    },

    ["d1_town_02a"] = {
        ["changelevels"] = {
            [1] = Vector(-6637, -745, -3257),
            [2] = Vector(-6529, -593, -3094)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-7479, -290, -3293),
                [2] = Vector(-7547, -154, -3405)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-7458, -208, -3402)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 160, 0)
		},

        ["checkpoint_functions"] = {
            [1] = function()
                for _, v in ipairs(player.GetAll()) do	
                    v:GrantAchievement("Hallowed Ground")
                end
            end
        }
    },

    ["d1_town_04"] = {
        ["changelevels"] = {
            [1] = Vector(-2688, 1024, -4735),
            [2] = Vector(-2679, 1278, -4862)
        },

        ["changelevel_func"] = {
            [1] = function(ply) 
                if not table.HasValue(ply.hl2cr.AchProgress, "ZombieChopperActive") then return end
                ply:GrantAchievement("Zombie Chopper")
                table.RemoveByValue(ply.hl2cr.AchProgress, "ZombieChopperActive")
                SavePlayerData(ply)
            end
        },
    },

    ["d1_town_05"] = {
        ["changelevels"] = {
            [1] = Vector(-1634, 10894, 1015),
            [2] = Vector(-1727, 10916, 896)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-1041, 10321, 898),
                [2] = Vector(-1224, 10465, 1014)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-1101, 10431, 905)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 150, 0)
		}
    },

    ["d2_coast_01"] = {
        ["changelevels"] = {
            [1] = Vector(-12091, 4070, 1689),		
            [2] = Vector(-11584, 4384, 1540)
        }
    },

    ["d2_coast_03"] = {
        ["changelevels"] = {
            [1] = Vector(6274, 13159, 197),
            [2] = Vector(7177, 13340, 41)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(8727, 4527, 372),
                [2] = Vector(8872, 4153, 258)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(8777, 4344, 267)
        },
			
		["checkpoint_angle"] = {
			[1] = Angle(0, 180, 0)
		},

        ["checkpoint_functions"] = {
            [1] = function()
                --disableJeepGlobal = true
				GAMEMODE:DisableVehicles(true)
			    --for _, v in ipairs(player.GetAll()) do
				--	GAMEMODE:RemoveVehicle(v)
				--end
			end
        },
		
		["pushers"] = {		--Prevents skipping gunship battle
            [1] = {
                [1] = Vector(5900, 5750, 510),
                [2] = Vector(7050, 6910, 840)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(7840, 4450, 430)
        }
    },

    ["d2_coast_04"] = {
        ["changelevels"] = {
            [1] = Vector(-3806, 10753, 1922),
            [2] = Vector(-4263, 10241, 1793)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(6204, -3945, 529),
                [2] = Vector(5888, -3701, 384)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(6049, -3863, 391)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 270, 0)
		}
    },

    ["d2_coast_05"] = {
        ["changelevels"] = {
            [1] = Vector(2682, 5504, 1342),
            [2] = Vector(2212, 6073, 1633)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-4465, -1648, 1088),
                [2] = Vector(-5144, -1288, 1258)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-4839, -1420, 1097)
        },
		["checkpoint_angle"] = {
			[1] = Angle(0, 35, 0)
		}
    },
    
    ["d2_coast_07"] = {
        ["changelevels"] = {
            [1] = Vector(3296, 5159, 1536),
            [2] = Vector(3358, 5132, 1664)
        },

        ["changelevels_special"] = {
            [1] = Vector(9438, -9582, 2050),
            [2] = Vector(8961, -9463, 2240)
        }
    },

    ["d2_coast_08"] = {
        ["changelevels"] = {
            [1] = Vector(3051, 1601, 1536),		
            [2] = Vector(3135, 1786, 1665)
        },
        
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(3062, -6920, 1922),
                [2] = Vector(2825, -7023, 2040)
            }
        },
        ["checkpoint_spot"] = {
            [1] = Vector(2954, -6999, 1927)
        },
		["checkpoint_angle"] = {
			[1] = Angle(0, 280, 0)
		}
    },

    ["d2_coast_09"] = {
        ["changelevels"] = {
            [1] = Vector(11503, -1684, -184),
            [2] = Vector(10983, -1947, 6)
        },
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(11179, 8389, -187),
                [2] = Vector(10869, 8636, -52)
            }
        },
        ["checkpoint_spot"] = {
            [1] = Vector(11012, 8545, -182)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 140, 0)
		}
    },
	
    ["d2_coast_10"] = {
        ["changelevels"] = {
            [1] = Vector(5161, 2652, 512),
            [2] = Vector(4916, 3135, 294)
        },
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(4773, -330, 1048),
                [2] = Vector(4932, -131, 916)
            },

            [2] = {
                [1] = Vector(8317, 1815, 962),
                [2] = Vector(8128, 1868, 1088)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(4838, -415, 928),
            [2] = Vector(8223, 1839, 966)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0),
			[2] = Angle(0, 160, 0)
		},

        ["checkpoint_functions"] = {
            [1] = function()
                --disableJeepGlobal = true
				GAMEMODE:DisableVehicles(true)
			    --for _, v in ipairs(player.GetAll()) do
				--	GAMEMODE:RemoveVehicle(v)
					--if v.vehicle and v.vehicle:IsValid() then
                    --    v.vehicle:Remove()
                    --    v.vehicle = nil
                    --end
				--end
			end
        },
		
		["pushers"] = {
            [1] = {
                [1] = Vector(8471,1780,880),
                [2] = Vector(3088,4778,226)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(4803,-2078,902)
        },
    },

    ["d2_coast_11"] = {
        ["changelevels"] = {
            [1] = Vector(-3288, 13717, 590),
            [2] = Vector(-3419, 13176, 300)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(4196, 6553, 717),
                [2] = Vector(4665, 6785, 577)
            },

            [2] = {	--extra checkpoint for just after ant queen kill
                [1] = Vector(4510, 9700, 120),		
                [2] = Vector(4970, 10460, 510)
            },

            [3] = {
                [1] = Vector(669, 11687, 481),		
                [2] = Vector(690, 11475, 663)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(4412, 6692, 588),
			[2] = Vector(4870, 9950, 220),
            [3] = Vector(591, 11602, 473)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 80, 0),
			[2] = Angle(0, 160, 0),
			[3] = Angle(0, 160, 0)
		},

        ["pushers"] = {
            [1] = {
                [1] = Vector(-468, 12100, 234),
                [2] = Vector(-700, 11706, 975)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(-63, 11694, 343)
        },

        ["checkpoint_functions"] = {
            [1] = function()
                if keepOffSand then
                    for k, sand in ipairs(ents.FindByClass("env_player_surface_trigger")) do
                        sand:Remove()
                    end
                    
                    for _, v in ipairs(player.GetAll()) do
                        v:GrantAchievement("Keep Off the Sand!")
                    end
                    
                    StayedOffSand = true
                end
			end
        }
    },

    ["d2_coast_12"] = {
        ["changelevels"] = {
            [1] = Vector(9214, 8471, 2206),
            [2] = Vector(9338, 8463, 2085)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(2048, -263, 672),
                [2] = Vector(2238, -318, 798),
            },

            [2] = {
                [1] = Vector(8842, 7747, 1039),		
                [2] = Vector(9024, 7657, 898)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(2138, -275, 681),
            [2] = Vector(8966, 7884, 924)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 90, 0),
			[2] = Angle(0, 140, 0)
		}
    },

    ["d2_prison_01"] = {
        ["changelevels"] = {
            [1] = Vector(537, -1598, 1601),
            [2] = Vector(705, -1432, 1741)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(1232, -1409, 1601),
                [2] = Vector(1138, -1597, 1724)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(1005, -1484, 1608)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 120, 0)
		}
    },

    ["d2_prison_02"] = {
        ["changelevels"] = {
            [1] = Vector(-2558, 1155, 787),
            [2] = Vector(-2797, 1310, 641)
        }
    },

    ["d2_prison_03"] = {
        ["changelevels"] = {
            [1] = Vector(-3567, 5954, 150),
            [2] = Vector(-3422, 6142, 1)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-3394, 3283, 157),
                [2] = Vector(-3583, 3392, 1)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-3474, 3376, 4)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 40, 0)
		}
    },

    ["d2_prison_04"] = {
        ["changelevels"] = {
            [1] = Vector(-1250, 3030, 386),
            [2] = Vector(-1437, 2881, 512)
        }
    },

    ["d2_prison_05"] = {
        ["changelevels"] = {
            [1] = Vector(-4052, -1080, 401),
            [2] = Vector(-4305, -980, 582)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-2348, 564, 895),
                [2] = Vector(-2185, 446, 769)
            },

            [2] = {
                [1] = Vector(-4250, -467, 646),
                [2] = Vector(-4032, -652, 486)
            },

            [3] = {
                [1] = Vector(-4685, -744, 642),
                [2] = Vector(-4440, -890, 772)
            }
        },
        
        ["checkpoint_spot"] = {
            [1] = Vector(-2253, 423, 778),		
            [2] = Vector(-4543, -571, 539),
			[3] = Vector(-4547, -924, 720)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 55, 0),
			[2] = Angle(0, 180, 0),
			[3] = Angle(0, 330, 0)
		}
    },

	--Alyx level that often derps
    ["d2_prison_06"] = {
        ["changelevels"] = {
            [1] = Vector(247, -2687, -240),
            [2] = Vector(-80, -2400, -111)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(1484, 606, -189),
                [2] = Vector(1617, 754, -73)
            },
            [2] = {
                [1] = Vector(267, -460, 115),
                [2] = Vector(359, -380, -63)
            },
            [3] = {
                [1] = Vector(511, -1031, 3),
                [2] = Vector(597, -835, 128)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(1564, 677, -245),
            [2] = Vector(310, -410, -54),
            [3] = Vector(576, -928, 9)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 180, 0),
			[2] = Angle(0, 310, 0),
			[3] = Angle(0, 310, 0)
		}
    },

    ["d2_prison_07"] = {
        ["changelevels"] = {
            [1] = Vector(4419, -4242, -567),
            [2] = Vector(4660, -4430, -693)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-346, -2863, -111),
                [2] = Vector(-534, -2788, -238)
            },
            [2] = {
                [1] = Vector(1588, -3267, -536),
                [2] = Vector(1474, -3359, -678)
            },

            [3] = {
                [1] = Vector(4333, -4093, -416),
                [2] = Vector(3986, -3905, -542)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-440, -2915, -237),
            [2] = Vector(1505, -3317, -672),
            [3] = Vector(4152, -3989, -536)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 270, 0),
			[2] = Angle(0, 340, 0),
			[3] = Angle(0, 200, 0)
		},

        ["pushers"] = {
            [1] = {
                [1] = Vector(524, -4014, -293),
                [2] = Vector(-881, -3848, -96)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(-421, -3328, -127)
        },
    },

    ["d2_prison_08"] = {
        ["changelevels"] = {
            [1] = Vector(-958, -962, 914),		
            [2] = Vector(-865, -1084, 1067)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-637, 640, 1215),
                [2] = Vector(-705, 972, 962)
            },
            [2] = {
                [1] = Vector(-590, 526, 1086),
                [2] = Vector(-289, 638, 929)
            },

            [3] = {
                [1] = Vector(638, 128, 1152),
                [2] = Vector(-254, 445, 961)
            },

            [4] = {
                [1] = Vector(162, -25, 1200),
                [2] = Vector(92, 50, 1228)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-930, 816, 964),
            [2] = Vector(-430, 558, 936),
            [3] = Vector(124, 276, 998),
            [4] = Vector(125, 3, 1215)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 310, 0),
			[2] = Angle(0, 320, 0),
			[3] = Angle(0, 200, 0),
			[4] = Angle(0, 90, 0)
		}
    },

    ["d3_c17_01"] = {
        ["changelevels"] = {
            [1] = Vector(-6780, -738, -257),
            [2] = Vector(-6604, -918, -81)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-7054, -1481, 0),
                [2] = Vector(-6995, -1275, 139)
            },
            [2] = {
                [1] = Vector(-6578, -891, 128),
                [2] = Vector(-6353, -1007, 1)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-6896, -1404, 9),	
            [2] = Vector(-6481, -930, 10)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 330, 0),
			[2] = Angle(0, 150, 0)
		}
    },
    
    ["d3_c17_02"] = {
        ["changelevels"] = {
            [1] = Vector(-5211, -4546, 130),
            [2] = Vector(-5142, -4471, 2)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-5565, -5185, 1),
                [2] = Vector(-5440, -5297, 173)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-5501, -5247, 5)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 80, 0)
		}
    },
    
    ["d3_c17_03"] = {
        ["changelevels"] = {
            [1] = Vector(-1084, -3490, 251),
            [2] = Vector(-960, -3583, 128)
        },
        ["changelevel_func"] = {
            [1] = function(ply)
                for _, v in ipairs(player.GetAll()) do
				v:GrantAchievement("Follow Freeman")
                end
            end
        }
    },

    ["d3_c17_04"] = {
        ["changelevels"] = {
            [1] = Vector(42, -5817, 247),
            [2] = Vector(141, -5879, 130)
        }
    },

    ["d3_c17_05"] = {
        ["changelevels"] = {
            [1] = Vector(2865, -3329, -126),
            [2] = Vector(2669, -3443, -1)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(1914, -3574, 568),
                [2] = Vector(1674, -3402, 449)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(1789, -3462, 453)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 120, 0)
		}
    },

	--level seems to have infinite manhacks spawner? may need limiting on exp
    ["d3_c17_06a"] = {
        ["changelevels"] = {
            [1] = Vector(2112, 2916, -35),
            [2] = Vector(2172, 2975, -126)
        },

        ["changelevel_func"] = {
            [1] = function(ply)
                for _, v in ipairs(player.GetAll()) do
                    v:GrantAchievement("Radiation Levels Detected")
                end
            end
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(3261, 2085, -320),
                [2] = Vector(2624, 2270, -196)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(2963, 2255, -312)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 100, 0)
		}
    },

    ["d3_c17_06b"] = {
        ["changelevels"] = {
            [1] = Vector(5374, 1774, 257),
            [2] = Vector(5280, 1679, 374)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(3133, 1404, 158),
                [2] = Vector(3064, 1281, 2)
            },

            [2] = {
                [1] = Vector(4306, 1918, 385),
                [2] = Vector(4511, 1860, 518)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(2984, 1346, 5),
            [2] = Vector(4427, 1918, 388)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0),
			[2] = Angle(0, 210, 0)
		}
    },

    ["d3_c17_07"] = {
        ["changelevels"] = {
            [1] = Vector(10190, 2954, -477),
            [2] = Vector(10117, 2852, -321)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(5628, 1482, 112),
                [2] = Vector(5538, 1349, 0)
            },

            [2] = {
                [1] = Vector(7394, 1282, 146),
                [2] = Vector(7526, 1790, 1)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(5602, 1401, 5),
            [2] = Vector(7487, 1544, 2)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0),
			[2] = Angle(0, 0, 0)
		}
    },

    ["d3_c17_08"] = {
        ["changelevels"] = {
            [1] = Vector(2599, -361, 665),
            [2] = Vector(2463, -485, 498)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(1315, -578, -195),
                [2] = Vector(1225, -631, -381)
            },

            [2] = {
                [1] = Vector(866, 638, 402),
                [2] = Vector(991, 534, 549)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(1257, -573, -374),
            [2] = Vector(922, 579, 406)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 80, 0),
			[2] = Angle(0, 320, 0)
		}
    },

    ["d3_c17_09"] = {
        ["changelevels"] = {
            [1] = Vector(9286, 7058, 151),
            [2] = Vector(9328, 7151, 1)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(6208, 6493, 195),
                [2] = Vector(6145, 6419, 299)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(6244, 6448, 201)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 30, 0)
		}
    },
		
    ["d3_c17_10a"] = {
        ["changelevels"] = {
            [1] = Vector(528, 4974, 256),
            [2] = Vector(484, 4802, 409)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-2978, 6740, 129),
                [2] = Vector(-3069, 6806, 247)
            },
            
            [2] = {
                [1] = Vector(-1635, 8116.4, 134),
                [2] = Vector(-1228, 8170, 260)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-3023, 6760, 146),
            [2] = Vector(-1397, 8149, 192)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 270, 0),
			[2] = Angle(0, 20, 0)
		},

        ["checkpoint_functions"] = {
            [1] = function()
                ents.FindByClass("npc_barney")[1]:SetPos(Vector(-3015, 6936, 140))
			end
        }
    },

    ["d3_c17_10b"] = {
        ["changelevels"] = {
            [1] = Vector(2817, 1138, 827),
            [2] = Vector(2878, 1024, 705)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(2318, -756, 501),
                [2] = Vector(2909, -982, 257)
            },
            
            [2] = {
                [1] = Vector(2657, 971, 393),
                [2] = Vector(2719, 1085, 258)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(2443, -851, 281),
            [2] = Vector(2690, 1029, 268)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 50, 0),
			[2] = Angle(0, 30, 0)
		}
    },

    ["d3_c17_11"] = {
        ["changelevels"] = {
            [1] = Vector(1211, 3309, 1086),
            [2] = Vector(1262, 3396, 962)
        }
    },
    
    ["d3_c17_12"] = {
        ["changelevels"] = {
            [1] = Vector(-2569, 9152, -4),
            [2] = Vector(-2687, 9260, -127)
        }
    },
    
    ["d3_c17_12b"] = {
        ["changelevels"] = {
            [1] = Vector(-4423, 938, 95),
            [2] = Vector(-4518, 1057, -30)
        },

        ["changelevel_func"] = {
            [1] = function(ply)
                for _, v in ipairs(player.GetAll()) do
                    v:GrantAchievement("Giant Killer")
                end
            end
        },
        
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-8751, -1231, -255),
                [2] = Vector(-8611, -594, -100)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-8669, -912, -222)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0)
		}
    },

    ["d3_c17_13"] = {
        ["changelevels"] = {
            [1] = Vector(8301, 1796, -281),
            [2] = Vector(8455, 1978, -428)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(6190, -1289, 1),
                [2] = Vector(6111, -1318, 120)
            },
            
            [2] = {
                [1] = Vector(5487, 257, 2),
                [2] = Vector(4832, 725, 159)
            },

            [3] = {
                [1] = Vector(8321, 1086, -106),
                [2] = Vector(8445, 961, -197)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(6146, -1343, 12),
            [2] = Vector(5134, 449, 8),
            [3] = Vector(8393, 993, -189)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 300, 0),
			[2] = Angle(0, 60, 0),
			[3] = Angle(0, 100, 0)
		}
    },

    ["d3_citadel_01"] = {
        ["changelevels"] = {
            [1] = Vector(11329, 5982, -1772),
            [2] = Vector(11623, 5792, -1530)
        },

        ["changelevel_func"] = {
            [1] = function(ply)
                for k, v in ipairs(player.GetAll()) do
                    if v:InVehicle() then v:ExitVehicle() end
                    v:SetPos(Vector(11539, 5926, -1643))
                end
            end
        }
    },

    ["d3_citadel_03"] = {
        ["changelevels"] = {
            [1] = Vector(729, -382, 2497),
            [2] = Vector(587, -257, 2370)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(7742, -1050, 2113),
                [2] = Vector(7617, -906, 2303)
            },
            
            [2] = {
                [1] = Vector(3160, 254, 2369),
                [2] = Vector(3072, 130, 2567)
            }
        },

         ["checkpoint_functions"] = {
             [1] = function()
                 table.Empty(SPAWNING_WEAPONS)
                 table.insert(SPAWNING_WEAPONS, "weapon_physcannon")
                
                 for _, v in ipairs(player.GetAll()) do
                     v:StripWeapons()
                     v:Give("weapon_physcannon")
                 end
				 game.ConsoleCommand( "physcannon_mega_enabled 1" )
		 	end
        },

        ["checkpoint_spot"] = {
            [1] = Vector(7684, -995, 2138),
            [2] = Vector(3156, 197, 2373)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 90, 0),
			[2] = Angle(0, 180, 0)
		}
    },

    ["d3_citadel_04"] = {
        ["changelevels"] = {
            [1] = Vector(-1278, -7745, 6122),
            [2] = Vector(-1153, -8382, 6118)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(65, 991, 2791),
                [2] = Vector(416, 654, 2622)
            },
            
            [2] = {
                [1] = Vector(446, 159, 6402),
                [2] = Vector(65, -16, 6606)
            }
        },

        ["checkpoint_functions"] = {
            [1] = function()
                timer.Simple(0.1, function()
                    local lift = ents.FindByName("citadel_train_lift01_1")[1]
                    for l, spawn in pairs(ents.FindByClass("info_player_start")) do
                        spawn:SetPos(lift:GetPos() + Vector(0, 0, 75))
                        spawn:SetParent(lift)
                    end
                end)
			end,

            [2] = function()
                for l, spawn in pairs(ents.FindByClass("info_player_start")) do
                    spawn:SetParent(nil)
                end
            end
        },


        ["checkpoint_spot"] = {
            [1] = Vector(271, 822, 2612),
            [2] = Vector(260, 72, 6406)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 320, 0),
			[2] = Angle(0, 270, 0)
		}
    },

    ["d3_citadel_05"] = {
        ["changelevels"] = {
            [1] = Vector(14150, -9734, 8448),
            [2] = Vector(14466, -10106, 8753)
        },

        ["changelevel_func"] = {
            [1] = function(ply)
                for k, v in ipairs(player.GetAll()) do 
                    if v:InVehicle() then v:ExitVehicle() end
                    v:SetPos(Vector(14347, -9935, 8741))
                end
            end
        }
    },

    ["d3_breen_01"] = {
        ["checkpoints"] = {
            [1] = {
                [1] = Vector(-1617, -51, 1513),
                [2] = Vector(-1465, 63, 1344)
            },

            [2] = {
                [1] = Vector(-827, -126, -254),
                [2] = Vector(-766, 123, -62)
            },

            [3] = {
                [1] = Vector(-502, -375, 1449),
                [2] = Vector(-767, -510, 1282)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(-1576, -3, 1368),
            [2] = Vector(-635, 4, -248),
            [3] = Vector(-680, -420, 1292)
        },
		
		["checkpoint_angle"] = {
			[1] = Angle(0, 0, 0),
			[2] = Angle(0, 270, 0),
			[3] = Angle(0, 60, 0)
		},

        ["pushers"] = {
            [1] = {
                [1] = Vector(-782, 883, 1219),
                [2] = Vector(1036, -1081, 1079)
            }
        },

        ["pusher_spot"] = {
            [1] = Vector(-748, -7, 1344)
        }
    },

    ["d2_lostcoast"] = {
        ["changelevels"] = {
            [1] = Vector(1155, 2902, 2528),
            [2] = Vector(1046, 3018, 2556)
        },

        ["checkpoints"] = {
            [1] = {
                [1] = Vector(1857, 4768, 2564),
                [2] = Vector(1922, 4731, 2696),
            },
            
            [2] = {
                [1] = Vector(1723, 3482, 2853),
                [2] = Vector(1219, 3521, 2700)
            },

            [3] = {
                [1] = Vector(2110, 3005, 2691),
                [2] = Vector(1830, 2914, 2923)
            }
        },

        ["checkpoint_spot"] = {
            [1] = Vector(1888, 4662, 2571),
            [2] = Vector(1474, 3536, 2714),
            [3] = Vector(2041, 2979, 2698)
        }
    }
}

MAPS_NO_SUIT = {
    ["d1_trainstation_01"] = true,
	["d1_trainstation_02"] = true,
	["d1_trainstation_03"] = true,
	["d1_trainstation_04"] = true
}

MAPS_NO_PETS = {
    //HL2
    ["d1_trainstation_01"] = true,
	["d1_trainstation_02"] = true,
	["d1_trainstation_03"] = true,
	["d1_trainstation_04"] = true,
	["d1_trainstation_05"] = true,
    ["d1_eli_01"] = true,
    ["d3_citadel_03"] = true,
	["d3_citadel_04"] = true,
	["d3_citadel_05"] = true,
	["d3_breen_01"] = true,

    //EP1
    ["ep1_citadel_01"] = true,
    ["ep1_citadel_02"] = true,
    ["ep1_citadel_02b"] = true,
    ["ep1_citadel_03"] = true,
    ["ep1_citadel_04"] = true,
}

MAPS_SUPERGRAVGUN = {
	["d3_citadel_03"] = true,
	["d3_citadel_04"] = true,
	["d3_citadel_05"] = true,
	["d3_breen_01"] = true
}

AIRBOAT_MAPS = {
	["d1_canals_06"] = true,
	["d1_canals_07"] = true,
	["d1_canals_08"] = true,
	["d1_canals_09"] = true,
	["d1_canals_10"] = true
}

AIRBOAT_GUN_MAPS = {
	["d1_canals_12"] = true,
	["d1_canals_13"] = true
}

JEEP_MAPS = {
	["d2_coast_03"] = true,
	["d2_coast_04"] = true,
	["d2_coast_05"] = true,
	["d2_coast_07"] = true,
	["d2_coast_09"] = true,
	["d2_coast_10"] = true
}

NO_RESULT_MAPS = {
	["d1_trainstation_01"] = true,
	["d1_trainstation_02"] = true,
	["d1_trainstation_03"] = true,
	["d1_trainstation_04"] = true,
	["d1_trainstation_05"] = true,
	["d1_eli_01"] = true,
	["d3_citadel_05"] = true,
}

MAPS_NO_HL2CR_WEAPONS = {
    ["d1_trainstation_01"] = true,
	["d1_trainstation_02"] = true,
	["d1_trainstation_03"] = true,
	["d1_trainstation_04"] = true,
	["d1_trainstation_05"] = true,
    ["d3_citadel_03"] = true,
	["d3_citadel_04"] = true,
	["d3_citadel_05"] = true,
	["d3_breen_01"] = true
}

local function SetHL2Checkpoints()

    //Remove map changelevels, we'll make up our own
    //in case something unexpected happens
    for _, c in pairs(ents.FindByClass("trigger_changelevel")) do
        c:Remove()
    end

    //If this map doesn't have support, throw a message and stop here
    if not HL2_TRIGGERS[game.GetMap()] then
        print(MsgC(Color(255, 0, 0), "HL2 CO-OP RPG ERROR - MAP IS NOT SUPPORTED"))
        return
    end

    if HL2_TRIGGERS[game.GetMap()]["checkpoints"] then
        for i, t in ipairs(HL2_TRIGGERS[game.GetMap()]["checkpoints"]) do
            local checkpoint = ents.Create("trigger_checkpoint")
            checkpoint.Min = Vector(t[1])
            checkpoint.Max = Vector(t[2])
            checkpoint.Pos = Vector(t[2]) - ( Vector(t[1]) - Vector(t[1])) / 2
            checkpoint.TPPoint = Vector(HL2_TRIGGERS[game.GetMap()]["checkpoint_spot"][i])
			if HL2_TRIGGERS[game.GetMap()]["checkpoint_angle"] then checkpoint.TPAngles = Angle(HL2_TRIGGERS[game.GetMap()]["checkpoint_angle"][i]) or checkpoint.TPAngles end	--default to 0,0,0
            checkpoint.PointIndex = i
            checkpoint:SetPos(checkpoint.Pos)
            checkpoint:Spawn()
            
            checkpoint.lambdaModel = ents.Create("prop_dynamic")
            checkpoint.lambdaModel:SetModel("models/hl2cr_lambda.mdl")
            checkpoint.lambdaModel:SetPos( checkpoint.TPPoint + Vector(0, 0, 75))
            checkpoint.lambdaModel:Spawn()
            checkpoint.lambdaModel:ResetSequence("idle")
            checkpoint.lambdaModel:SetMaterial(checkpoint.Mat)

            if HL2_TRIGGERS[game.GetMap()]["checkpoint_functions"] then
                checkpoint.Func = HL2_TRIGGERS[game.GetMap()]["checkpoint_functions"][i]
            end
        end
    end

    if HL2_TRIGGERS[game.GetMap()]["changelevels"] and game.GetGlobalState("hl2cr_extendedmap") == GLOBAL_DEAD then
        local changelevel = ents.Create("trigger_changemap")
        changelevel.Min = Vector(HL2_TRIGGERS[game.GetMap()]["changelevels"][1])
        changelevel.Max = Vector(HL2_TRIGGERS[game.GetMap()]["changelevels"][2])
        changelevel.Pos = Vector(HL2_TRIGGERS[game.GetMap()]["changelevels"][2]) - 
        ( ( Vector(HL2_TRIGGERS[game.GetMap()]["changelevels"][2]) - Vector(HL2_TRIGGERS[game.GetMap()]["changelevels"][1])) 
        / 2 )
        
        changelevel:SetPos(changelevel.Pos)
        changelevel:Spawn()

        changelevel.lambdaModel = ents.Create("prop_dynamic")
        changelevel.lambdaModel:SetModel("models/hl2cr_lambda.mdl")
        changelevel.lambdaModel:SetPos(changelevel.Pos)
        changelevel.lambdaModel:Spawn()
        changelevel.lambdaModel:ResetSequence("idle")
        changelevel.lambdaModel:SetMaterial("phoenix_storms/wire/pcb_green")

        if HL2_TRIGGERS[game.GetMap()]["changelevel_func"] then
            changelevel.Func = HL2_TRIGGERS[game.GetMap()]["changelevel_func"][1]
        end
    end

    if HL2_TRIGGERS[game.GetMap()]["changelevels_special"] and game.GetGlobalState("hl2cr_extendedmap") == GLOBAL_ON then
        local special_changelevel = ents.Create("trigger_changemap")
        special_changelevel.Min = Vector(HL2_TRIGGERS[game.GetMap()]["changelevels_special"][1])
        special_changelevel.Max = Vector(HL2_TRIGGERS[game.GetMap()]["changelevels_special"][2])
        special_changelevel.Pos = Vector(HL2_TRIGGERS[game.GetMap()]["changelevels_special"][2]) - 
        ( ( Vector(HL2_TRIGGERS[game.GetMap()]["changelevels_special"][2]) - Vector(HL2_TRIGGERS[game.GetMap()]["changelevels_special"][1])) 
        / 2 )
        
        special_changelevel:SetPos(special_changelevel.Pos)
        special_changelevel:Spawn()

        special_changelevel.lambdaModel = ents.Create("prop_dynamic")
        special_changelevel.lambdaModel:SetModel("models/hl2cr_lambda.mdl")
        special_changelevel.lambdaModel:SetPos(special_changelevel.Pos)
        special_changelevel.lambdaModel:Spawn()
        special_changelevel.lambdaModel:ResetSequence("idle")
        special_changelevel.lambdaModel:SetMaterial("phoenix_storms/wire/pcb_green")
    end

    if HL2_TRIGGERS[game.GetMap()]["pushers"] then
        for i, p in ipairs(HL2_TRIGGERS[game.GetMap()]["pushers"]) do
            local pusher = ents.Create("trigger_pushback")
            pusher.Min = Vector(p[1])
            pusher.Max = Vector(p[2])
            pusher.Pos = Vector(p[2]) - ( ( Vector(p[2]) - Vector(p[1])) / 2 )
            pusher:SetPos(pusher.Pos)
            pusher:Spawn()
            pusher.TPSpot = HL2_TRIGGERS[game.GetMap()]["pusher_spot"][i]
        end
    end

    if HL2_LAMBDA_TRIGGERS[game.GetMap()] then
        for i, l in ipairs(HL2_LAMBDA_TRIGGERS[game.GetMap()]) do
            local lambdaTrigger = ents.Create("trigger_lambda")
            lambdaTrigger.Min = Vector(l[1])
            lambdaTrigger.Max = Vector(l[2])
            lambdaTrigger.Pos = Vector(l[2]) - ( ( Vector(l[2]) - Vector(l[1])) / 2 )
            lambdaTrigger:SetPos(lambdaTrigger.Pos)
            lambdaTrigger:Spawn()
            lambdaTrigger.Index = i
        end
    end
end

local maps_trainstation = {
    ["d1_trainstation_01"] = true,
    ["d1_trainstation_02"] = true,
    ["d1_trainstation_03"] = true,
    ["d1_trainstation_05"] = true
}

local remove_vehicles = {
	["prop_vehicle_airboat"] = true,
	["pro_vehicle_jeep_old"] = true,
	["pro_vehicle_jeep"] = true
}

local fix_spawns_maps = {
    ["d1_trainstation_02"] = true,
    ["d2_coast_10"] = true,
    ["d2_prison_01"] = true,
    ["d2_prison_03"] = true,
    ["d2_prison_05"] = true,
    ["d3_c17_07"] = true,
    ["d3_c17_12"] = true,
}

local ravenball_pos = {
    ["d1_town_01"] = Vector(4476, -2591, -3753),
    ["d1_town_01a"] = Vector(225, 161, -3305),
    ["d1_town_02"] = Vector(-963, 894, -3427),
    ["d1_town_03"] = Vector(-3647, -710, -3569),
    ["d1_town_02a"] = Vector(-5267, 2364, -3278),
    ["d1_town_04"] = Vector(747, -1168, -3631),
}

local function SetUpMisc()

    MapLua = ents.Create("lua_run")
	MapLua:SetName("hl2crlua")
	MapLua:Spawn()

    if fix_spawns_maps[game.GetMap()] then
        for i, sp in ipairs(ents.FindByClass("info_player_start")) do
            if i == 1 then continue end
            sp:Remove()
        end
    end

    if game.GetGlobalState("hl2cr_bringitem_whatbaby") == GLOBAL_ON then
        local doll = ents.Create("prop_physics")
        doll:SetModel("models/props_c17/doll01.mdl")
        if game.GetMap() == "d1_trainstation_05" then
            doll:SetPos(ents.FindByClass("info_player_start")[2]:GetPos())
        else
            doll:SetPos(ents.FindByClass("info_player_start")[1]:GetPos())
            game.SetGlobalState("hl2cr_bringitem_whatbaby", GLOBAL_DEAD)
        end
        
        doll:Spawn()
    end
    
    if game.GetGlobalState("hl2cr_bringitem_rollermine") == GLOBAL_ON then
        game.SetGlobalState("hl2cr_bringitem_rollermine", GLOBAL_DEAD)
        
        local ball = ents.Create("prop_physics")
        ball:SetModel("models/roller.mdl")

        if game.GetGlobalState("hl2cr_extendedmap") == GLOBAL_ON then
            ball:SetPos(Vector(-3721, 78, -3445))
        else
            ball:SetPos(ravenball_pos[game.GetMap()])
        end
        
        ball:Spawn()
    end


    SetGlobalBool( "HL2CR_GLOBAL_SUIT", false )

    for _, failer in ipairs(ents.FindByName("fall_trigger")) do
		failer:Remove()
	end

    timer.Simple(0.1, function()
		for _, ent in ipairs(ents.GetAll()) do
			if string.find(ent:GetName(), "global_newgame_") and not remove_vehicles[ent:GetClass()] then
				ent:Remove()
			end
		end
	end)
	
	if HL2_WEAPONS[game.GetMap()] then
		for i, wep in pairs(HL2_WEAPONS[game.GetMap()]) do 
			table.insert(SPAWNING_WEAPONS, wep)
		end
	end
	
	if HL2_EQUIPMENT[game.GetMap()] then
		table.insert(SPAWNING_ITEMS, HL2_EQUIPMENT[game.GetMap()])
	end

    for _, portal in ipairs(ents.FindByClass("func_areaportal")) do
		portal:SetKeyValue("StartOpen", "1")
	end
	
	if game.GetMap() == "d1_trainstation_01" then
		game.SetGlobalState("gordon_precriminal", 1)
		game.SetGlobalState("gordon_invulnerable", 1)

        for _, v in ipairs(ents.FindByClass("point_viewcontrol")) do
            v:Remove()
        end

        for _, t in ipairs(ents.FindByName("track_viewcontrol_final_*")) do
            t:Remove()
        end
	end

    if game.GetMap() == "d1_trainstation_02" then
        ents.FindByName("player_escape_trigger")[1]:Remove()
        ents.FindByName("trashcan_trigger")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:CanCopAch(false):0:-1")
        ents.FindByName("cupcop_fail_relay")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:CanCopAch(true):0:-1")
    end

    if maps_trainstation[game.GetMap()] then
        game.SetGlobalState("gordon_invulnerable", 1)
        game.SetGlobalState("gordon_precriminal", 1)		
    else
        game.SetGlobalState("gordon_invulnerable", 0)
        game.SetGlobalState("gordon_precriminal", 0)
    end

	if game.GetMap() == "d1_trainstation_05" then
        if game.GetGlobalState("hl2cr_bringitem_whatbaby") == GLOBAL_ON then
            ents.FindByName("1_kleiner_teleport_trigger_1")[1]:SetKeyValue("spawnflags", 8)
            ents.FindByName("1_kleiner_teleport_trigger_1")[1]:Fire("AddOutput", "OnStartTouch hl2crlua:RunPassedCode:BabyCheck(ACTIVATOR):0:-1")
            game.SetGlobalState("hl2cr_bringitem_whatbaby", GLOBAL_DEAD)
        end

		ents.FindByName("kill_mtport_rl_1")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:GiveWhatCat():2:-1" )
	end

    if game.GetMap() == "d1_trainstation_06" then
        ents.FindByClass("info_player_start")[1]:SetPos(Vector(-9946, -3652, 326))
    end

    if game.GetMap() == "d1_canals_02" then
		ents.FindByName("underground_door_basinexit2")[1]:Fire("AddOutput", "OnOpen hl2crlua:RunPassedCode:RemovePushTrigger()")
	end

    if game.GetMap() == "d1_canals_07" then
		local blocker_1 = ents.Create("prop_dynamic")
		blocker_1:SetModel("models/props_lab/blastdoor001b.mdl")
		blocker_1:SetPos(Vector(7000, 1384, -260))
		
        blocker_1:SetName("blocker_1")
		blocker_1:PhysicsInit(SOLID_VPHYSICS)
		blocker_1:Spawn()

        local blocker_2 = ents.Create("prop_dynamic")
		blocker_2:SetModel("models/props_lab/blastdoor001b.mdl")
		blocker_2:SetPos(Vector(7000, 1300, -260))
        blocker_2:SetName("blocker_2")
		blocker_2:PhysicsInit(SOLID_VPHYSICS)
		blocker_2:Spawn()

        ents.FindByName("gatehouse_door2")[1]:Fire("AddOutput", "OnOpen hl2crlua:RunPassedCode:RemoveBlockers()")
		ents.FindByName("gatehouse_door2")[1]:Fire("AddOutput", "OnOpen hl2crlua:RunPassedCode:RemovePushTrigger()")
        ents.FindByModel("models/props_c17/oildrum001_explosive.mdl")[5]:Remove()
	end
	
	if game.GetMap() == "d1_canals_10" then
		ents.FindByClass("info_player_start")[1]:SetPos(Vector(11911, -12159, -499))
	end
	
	if game.GetMap() == "d1_canals_11" then
		--Force npc to open gate sequence without players needing to get back into boat
		ents.FindByName("lcs_gc_briefing1_post")[1]:Fire("AddOutput", "OnCompletion lcs_guncave_goodbye1:start:1:-1")
	end

    if game.GetMap() == "d1_eli_02" then
		for k, g in ipairs( ents.FindByName( "trigger_Get_physgun" )) do
			g:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:GiveGravGun()" )
		end

		for k, basket in ipairs(ents.FindByName("trigger_BBall_score_top")) do
			basket:Fire("AddOutput", "OnEndTouch hl2crlua:RunPassedCode:GiveBallAch():0:-1" )
		end
	end

    if game.GetMap() == "d1_town_02" then	--Remove pusher when lift down button activated
		ents.FindByName("freight_lift_button_2")[1]:Fire("AddOutput", "OnPressed hl2crlua:RunPassedCode:RemovePushTrigger()")
	end

    if game.GetMap() == "d1_town_03" then	--Remove pusher that prevents skipping lever
		ents.FindByName("street_lever")[1]:Fire("AddOutput", "OnPressed hl2crlua:RunPassedCode:RemovePushTrigger()")
	end

    if game.GetGlobalState("hl2cr_extendedmap") == GLOBAL_ON and game.GetMap() == "d1_town_02" then
		for i, s in ipairs(ents.FindByClass("info_player_start")) do
			s:SetPos(Vector(-3763, -36, -3439))
			s:SetAngles(Angle(0, 90, 0))
		end
		timer.Simple(3, function()RemovePushTrigger() end)	--Removes lift skip Pusher trigger
    end

    if ( game.GetMap() == "d1_town_02a" or game.GetMap() == "d2_coast_09" ) and game.GetGlobalState("hl2cr_extendedmap") == GLOBAL_ON then
		game.SetGlobalState("hl2cr_extendedmap", GLOBAL_DEAD)
		print("---KILLING GLOBAL---")
	end

    if game.GetMap() == "d2_coast_01" then
		local fixLeap = ents.Create("prop_dynamic")
		fixLeap:SetPos(Vector(-8606, 476, 961))
		fixLeap:SetAngles(Angle(0, 180, 0))
		fixLeap:SetModel("models/props_wasteland/cargo_container01.mdl")
		fixLeap:PhysicsInit(SOLID_VPHYSICS)
		fixLeap:Spawn()
		
		local fixLeap2 = ents.Create("prop_dynamic")
		fixLeap2:SetPos(Vector(-8477, 476, 961))
		fixLeap2:SetAngles(Angle(0, 180, 0))
		fixLeap2:SetModel("models/props_wasteland/cargo_container01.mdl")
		fixLeap2:PhysicsInit(SOLID_VPHYSICS)
		fixLeap2:Spawn()
	end
	
	if game.GetMap() == "d2_coast_03" then
		--blocks shortcut more naturally
		local cliff = ents.Create("prop_dynamic")	
		cliff:SetPos(Vector(3580,10120,620))
		cliff:SetAngles(Angle(0,345,0))
		cliff:SetModel("models/props_wasteland/rockcliff_cluster01b.mdl")
		cliff:PhysicsInit(SOLID_VPHYSICS)
		cliff:DrawShadow( false)
		cliff:Spawn()
	
		ents.FindByName("gunship_spawner_2")[1]:Fire("AddOutput", "OnAllSpawnedDead hl2crlua:RunPassedCode:OpenGateCoast():0:-1" )
		--ents.FindByName("gunship_spawner_2")[1]:Fire("AddOutput", "OnAllSpawnedDead hl2crlua:RunPassedCode:RemovePushTrigger():0:-1" )
	end
	
	if game.GetMap() == "d2_coast_04" then
		local fixLeap = ents.Create("prop_dynamic")
		fixLeap:SetPos(Vector(-1813, 1204, 860))
		fixLeap:SetAngles(Angle(0, -90, 0))
		fixLeap:SetModel("models/props_wasteland/cargo_container01.mdl")
		fixLeap:PhysicsInit(SOLID_VPHYSICS)
		fixLeap:Spawn()
		
		local fixLeap2 = ents.Create("prop_dynamic")
		fixLeap2:SetPos(Vector(-1813, 1074, 860))
		fixLeap2:SetAngles(Angle(0, -90, 0))
		fixLeap2:SetModel("models/props_wasteland/cargo_container01.mdl")
		fixLeap2:PhysicsInit(SOLID_VPHYSICS)
		fixLeap2:Spawn()
	end

    if game.GetMap() == "d2_coast_07" and game.GetGlobalState("hl2cr_extendedmap") == GLOBAL_ON then
		ents.FindByClass("npc_combinedropship")[1]:Remove()
		ents.FindByClass("info_player_start")[1]:SetPos(Vector(3148, 5263, 1540))
		ents.FindByClass("info_player_start")[1]:SetAngles(Angle(0, 180, 0))
		timer.Simple(10, function()
			for _, forcefield in ipairs(ents.FindByName("bridge_field_02")) do
				forcefield:Remove()
			end
		end)
	end
    
    if game.GetMap() == "d2_coast_08" then	--Under bridge level
        blocker = ents.Create("prop_dynamic")
		blocker:SetModel("models/props_doors/door03_slotted_left.mdl")
		blocker:SetPos(Vector(3305, 1542, 1588))
		blocker:SetAngles(Angle(0, -90, 0))
		blocker:PhysicsInit(SOLID_VPHYSICS)
		blocker:Spawn()
        
		ents.FindByClass("info_player_start")[1]:SetPos(Vector(3330, 1471, 1600))
		ents.FindByClass("info_player_start")[1]:SetAngles(Angle(0, -90, 0))
		
		--for k, fog in ipairs(ents.FindByClass("env_fog_controller")) do
			--fog:Remove()
		--end

        --ents.FindByName("button_trigger")[1]:Fire("AddOutput", "OnClose hl2crlua:RunPassedCode:RemoveBridgeBlocker():0:-1" )
		ents.FindByName("gunship")[1]:Fire("AddOutput", "OnDeath hl2crlua:RunPassedCode:RemoveBridgeBlocker():0:-1" )	--Force gunship fight
	end
	
	if game.GetMap() == "d2_coast_09" then	--Corrects spawn angle being sideways
		ents.FindByClass("info_player_start")[1]:SetAngles(Angle(0, -90, 0))
	end
	
	if game.GetMap() == "d2_coast_10" then	
		ents.FindByName("lighthouse_secret_door")[1]:Fire("AddOutput", "OnOpen hl2crlua:RunPassedCode:RemovePushTrigger()")
	end
	
	if game.GetMap() == "d2_coast_11" then
		StayedOffSand = false
		keepOffSand = true
	end

    if game.GetMap() == "d2_coast_11" then
        ents.FindByName("scene_tutorial_exit")[1]:Fire("AddOutput", "OnCompletion hl2crlua:RunPassedCode:RemovePushTrigger()")
    end

	if game.GetMap() == "d2_prison_06" then	--Corrects spawn angle being sideways
		ents.FindByClass("info_player_start")[1]:SetAngles(Angle(0, -70, 0))
	end

    if game.GetMap() == "d2_prison_07" then
		ents.FindByName("logic_finished_betrayal")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:RemovePushTrigger()")
	end

	if game.GetMap() == "d3_c17_10a" then	--Has multiple spawns strangly?
		if ents.FindByClass("info_player_start")[1]:IsValid() then	
			for l, spawn in pairs(ents.FindByClass("info_player_start")) do
				spawn:SetPos(Vector(-3930, 6780, 5))
				spawn:SetAngles(Angle(0, 0, 0))
			end
		end
	end

    if game.GetMap() == "d3_c17_10b" then
		ents.FindByName("s_room_detected_relay")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:ResetLaserTrap():15:-1" )
	end

	if game.GetMap() == "d3_citadel_03" then
        game.SetGlobalState("super_phys_gun", GLOBAL_ON)

		--logic_weapon_strip_physcannon_start trigger
		timer.Simple(18, function()	--trapdoor does not seem to wake up blocking progress so removing it
			for _, logic in ipairs(ents.FindByName("logic_weapon_strip_physcannon_start")) do
				--game.ConsoleCommand( "ent_fire logic_weapon_strip_physcannon_start trigger" )
				logic:Fire("Trigger")
			end
		end)
	end

    if game.GetMap() == "d3_breen_01" then
		local setPos = Vector(-2183, 836, 587)
        
        for k, spawn in ipairs(ents.FindByClass("info_player_start")) do
			spawn:SetPos(setPos)
		end
        
		ents.FindByClass("item_suit")[1]:SetPos(setPos)
		
		ents.FindByClass("player_loadsaved")[1]:Remove()
		
		ents.FindByName("logic_swap")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:FinishHL2():10:-1" )

        ents.FindByName("relay_breenwins")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:FailedMap():0:-1")
        
        ents.FindByClass("trigger_pushback")[1]:Fire("Disable")
        ents.FindByName("logic_portal_final_end")[1]:Fire("AddOutput", "OnTrigger hl2crlua:RunPassedCode:EnablePushTrigger():0:-1" )
	end
end

function StartHL2()
	SetHL2Checkpoints()
    SetUpVortex()
	SetUpMisc()
	//SetUpLambdas()
end

function FinishHL2()
	for k, v in ipairs(player.GetAll()) do
		v:SetTeam(TEAM_COMPLETED_MAP)
		v:GrantAchievement("Singularity Collapse")
	end
	
	BroadcastMessageToAll(HL2CR_LevelupColour, translate.Get("Campaign_Finished_HL2"))
	
	StartFinalMapCountdown()
end

hook.Add( "PlayerFootstep", "CustomFootstep", function( ply, pos, foot, sound, volume, rf )
	if game.GetMap() == "d2_coast_11" then
		if string.find(sound, "sand") and (keepOffSand and not StayedOffSand) then
			FailSandAchievement(ply)
		end
	end

	return false 
end)

function FailSandAchievement(ply)		
	BroadcastMessageToAll(HL2CR_RedColour, translate.Get("Failed_HL2_Sand"), ply:Nick())
	keepOffSand = false
end

function CanCopAch(isDefiant)
    for _, v in ipairs(player.GetAll()) do
        if isDefiant then
            v:GrantAchievement("Defiant")
        else
            v:GrantAchievement("Submissive")
        end
    end
end

function BabyCheck(ACTIVATOR)
    if ACTIVATOR:GetClass() == "func_physbox" then
        ACTIVATOR:Remove()
        return
    end
 
    ents.FindByName("1_kleiner_teleport_trigger_1")[1]:SetKeyValue("spawnflags", 1)

    if ACTIVATOR:GetClass() == "prop_physics" and ACTIVATOR:GetModel() == "models/props_c17/doll01.mdl" then
        for _, v in ipairs(player.GetAll()) do
            v:GrantAchievement("What Baby?")
        end

        game.SetGlobalState("hl2cr_bringitem_whatbaby", GLOBAL_DEAD)
    end

    timer.Simple(0.5, function()
        ents.FindByName("1_kleiner_teleport_trigger_1")[1]:SetKeyValue("spawnflags", 1)
    end)
end

function RemoveBridgeBlocker()
    blocker:Remove()
end


function RemoveBlockers()
    if ents.FindByName("blocker_1")[1] then
        ents.FindByName("blocker_1")[1]:Remove()
    end

    if ents.FindByName("blocker_2")[1] then
        ents.FindByName("blocker_2")[1]:Remove()
    end
end

function RemovePushTrigger()
	local pusher = ents.FindByClass("trigger_pushback")
	if pusher then ents.FindByClass("trigger_pushback")[1]:Remove() end
end

function EnablePushTrigger()
    local pusher = ents.FindByClass("trigger_pushback")
	if pusher then ents.FindByClass("trigger_pushback")[1]:Fire("Enable") end
end

hook.Add("GravGunOnPickedUp", "HL2CR_Achievement_BlastPast", function(ply, ent)
    if game.GetMap() == "d1_eli_02" then
        if ent:GetModel() == "models/props_lab/hevplate.mdl" then
            ply:GrantAchievement("Blast from the Past")
        end
    end
end)

function GiveGravGun()
	for _, v in ipairs(player.GetAll()) do
		v:Give("weapon_physcannon")
		v:GrantAchievement("Zero-Point Energy")
	end
end

function GiveBallAch()
	for _, v in ipairs(player.GetAll()) do
		v:GrantAchievement("Two Points")
	end
end

function GiveWhatCat()
	for _, v in ipairs(player.GetAll()) do
		v:GrantAchievement("What Cat?")
	end
end

function OpenGateCoast()
	for k, v in ipairs(ents.FindByName("village_gate")) do
		v:Fire("Open")
	end

	RemovePushTrigger()
	--disableJeepGlobal = false
	GAMEMODE:DisableVehicles(false)
	for _, v in ipairs(player.GetAll()) do
		v:GrantAchievement("Where Cubbage Fears to Tread")
	end
end

function ResetLaserTrap()
    for k, laser in ipairs(ents.FindByName("s_laser*")) do
		laser:Fire("TurnOn")
	end
	
	for p, door in ipairs(ents.FindByName("s_room_doors")) do
		door:Fire("Open")
	end
	
	for t, turret in ipairs(ents.FindByName("s_room_turret_*")) do
		turret:Fire("Disable")
	end
	
	ents.FindByName("s_room_panelswitch")[1]:Fire("UnLock")
end