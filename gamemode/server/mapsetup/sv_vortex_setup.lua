local vortex_map_pos = {
    ["d1_trainstation_04"] = {
        [1] = Vector(-3728, -3856, 534),
        [2] = Vector(-3918, -3290, 629)
    },
    
    ["d1_trainstation_05"] = {
        [1] = Vector(-6820, -1593, 131)
    },

    ["d1_trainstation_06"] = {
        [1] = Vector(-7792,-2290,148)
    },
---------------------------------------------------
    ["d1_canals_01"] = {
        [1] = Vector(471,-177,52)
    },
	
    ["d1_canals_02"] = {
        [1] = Vector(-1038,-1112,-765),
		[2] = Vector(-35,1104,-756)
    },

    ["d1_canals_03"] = {
        [1] = Vector(-608,1040,-815),
		[2] = Vector(-107,137,-876),
		[3] = Vector(-3359,-822,-874)
    },

    ["d1_canals_06"] = {
        [1] = Vector(-1457,5452,-156),
		[2] = Vector(546,5402,-228),
    },
	
    ["d1_canals_07"] = {
        [1] = Vector(7749,1875,-170),
		[2] = Vector(3949,-7219,-917),
		[3] = Vector(-2844,-8335,-750),
		[4] = Vector(-11084,-12026,-976)
    },
	
    ["d1_canals_08"] = {
        [1] = Vector(1898,-521,-484),
		[2] = Vector(-62,-2265,-365),
		[3] = Vector(-2723,-3301,-366),
		[4] = Vector(-7549,2539,-575)
    },
	
    ["d1_canals_09"] = {
        [1] = Vector(1554,8834,-267),
		[2] = Vector(3328,-8706,-372),
    },
	
    ["d1_canals_10"] = {
        [1] = Vector(13807,-1800,-173),
		[2] = Vector(8680,522,-364),
		[3] = Vector(3870,9192,-230),
		[4] = Vector(-8738,955,-356)
    },
	
    ["d1_canals_11"] = {
        [1] = Vector(5914,5344,-876),
    },
	
    ["d1_canals_12"] = {
        [1] = Vector(7730,8041,454),
		[2] = Vector(631,7323,490),
		[3] = Vector(-6703,4162,663)
    },
	
    ["d1_canals_13"] = {
        [1] = Vector(-10111,-2964,-296),
		[2] = Vector(-1793,3948,-328),
		[3] = Vector(10935,1353,-267)
    },

---------------------------------------------------
    ["d1_eli_01"] = {
        [1] = Vector(227, 3600, -1343),
        [2] = Vector(547, 2087, -2436),
		[3] = Vector(-1455,4669,-1416)
    },

    ["d1_eli_02"] = {
        [1] = Vector(-906,393,-2343),
        [2] = Vector(-2385,-381,-2669),
		[3] = Vector(-2248,1533,-2650)
    },
---------------------------------------------------
    ["d1_town_01"] = {
        [1] = Vector(3600,-2224,-3886),
        [2] = Vector(1323,-1492,-3524),
    },

    ["d1_town_01a"] = {
        [1] = Vector(-595,599,-3554)
    },

    ["d1_town_02"] = {
        [1] = Vector(-1874,443,-3280),
		[2] = Vector(-4292,1025,-3446),
		[3] = Vector(-3856,797,-3181)
    },
	
    ["d1_town_03"] = {
        [1] = Vector(-3347,-1731,-3606),
        [2] = Vector(-1130,-1296,-3757),
		[3] = Vector(-1681,-2031,-3524)
    },
	
    ["d1_town_04"] = {
        [1] = Vector(289,-1628,-4643),
        [2] = Vector(1582,298,-5086),
		[3] = Vector(2360,-414,-5292)
    },
	
    ["d1_town_05"] = {
        [1] = Vector(48,7327,970),
        [2] = Vector(-1048,10322,1042),
    },
---------------------------------------------------
    ["d2_coast_01"] = {
        [1] = Vector(-4931,-11155,580),
		[2] = Vector(-12658,-3688,1261),
    },
	
    ["d2_coast_03"] = {
        [1] = Vector(-3805,3654,373),
		[2] = Vector(-220,9302,226),
		[3] = Vector(2521,7459,240),
		[4] = Vector(6468,4632,308)
    },

    ["d2_coast_04"] = {
        [1] = Vector(4470,-69,140),
		[2] = Vector(4263,-5667,574),
		[3] = Vector(2880,3471,910),
		[4] = Vector(2064,5256,1330)
    },
	
    ["d2_coast_05"] = {
        [1] = Vector(-5615,-11068,900),
		[2] = Vector(-4939,-11389,1200),
		[3] = Vector(194,1090,1138),
		[4] = Vector(1532,1569,1103)
    },
	
    ["d2_coast_07"] = {
        [1] = Vector(1160,5264,1635),
		[2] = Vector(-12658,-3688,1261),
    },
	
    ["d2_coast_08"] = {
        [1] = Vector(3632,1840,1555),
		[2] = Vector(3574,-1362,1812),
		[3] = Vector(3664,-5643,1812)
    },
	
    ["d2_coast_09"] = {
        [1] = Vector(797,-6455,-537),
		[2] = Vector(1103,5370,-767),
    },

    ["d2_coast_10"] = {
        [1] = Vector(4911,-218,1091),
		[2] = Vector(4819,1107,1071),
		[3] = Vector(7596,1682,518)
    },
	
    ["d2_coast_11"] = {
        [1] = Vector(1200,-286,307),
		[2] = Vector(6767,3535,70),
		[3] = Vector(2054,9381,181)
    },
	
    ["d2_coast_12"] = {
        [1] = Vector(2096,-4186,663),
		[2] = Vector(5289,3703,618),
		[3] = Vector(9440,7992,1828)
    },
---------------------------------------------------

    ["d2_prison_01"] = {
        [1] = Vector(4756,-3230,1428),
		[2] = Vector(1552,-2838,1642),
    },
	
    ["d2_prison_02"] = {
        [1] = Vector(-2095,3440,389),
		[2] = Vector(-2225,2293,276),
    },
	
    ["d2_prison_03"] = {
        [1] = Vector(-3877,4950,20),
		[2] = Vector(-3489,2350,147),
    },
	
    ["d2_prison_04"] = {
        [1] = Vector(-464,1971,275),
		[2] = Vector(-486,1895,416),
    },
	
    ["d2_prison_05"] = {
        [1] = Vector(-4632,-1004,807),
    },
	
    ["d2_prison_06"] = {
        [1] = Vector(1373,350,-616),
		[2] = Vector(411,-720,-43),
		[3] = Vector(803,-2052,-222)
    },
	
   ["d2_prison_07"] = {
        [1] = Vector(2304,-3853,-662),
		[2] = Vector(411,-720,-43),
		[3] = Vector(803,-2052,-222)
    },
---------------------------------------------------
	
   ["d3_c17_01"] = {
        [1] = Vector(-7035,-1089,115),
    },
	
   ["d3_c17_02"] = {
        [1] = Vector(-8202,-6301,-44),
    },
	
   ["d3_c17_03"] = {
        [1] = Vector(-5486,-3520,83),
    },
	
   ["d3_c17_04"] = {
        [1] = Vector(-1893,-3737,369),
    },
	
   ["d3_c17_05"] = {
        [1] = Vector(402,-6498,596),
		[2] = Vector(977,-5956,34),
		[3] = Vector(1680,-4540,85),
		[4] = Vector(2284,-3137,211)
    },
	
   ["d3_c17_06b"] = {
        [1] = Vector(3707,1142,276),
		[2] = Vector(3630,1945,404)
    },
	
   ["d3_c17_07"] = {
        [1] = Vector(8271,3177,-228),
    },
	
   ["d3_c17_08"] = {
        [1] = Vector(-2583,-1966,121),
		[2] = Vector(1366,-1860,-301)
    },
	
   ["d3_c17_09"] = {
        [1] = Vector(6158,5848,23),
		[2] = Vector(6031,6363,498)
    },
	
   ["d3_c17_13"] = {
        [1] = Vector(5848,-239,148),
		[2] = Vector(5367,-1496,147)
    },
---------------------------------------------------
   ["d3_citadel_01"] = {
        [1] = Vector(6510,4239,-422),
		[2] = Vector(7575,4231,-1856),
		[3] = Vector(10520,4904,-1758)
    },
	
   ["d3_citadel_03"] = {
        [1] = Vector(6952,2391,2132),
    },
}

VortexBall = VortexBall or nil

local function ShouldSpawnVortex()
    return math.random(1, 100) <= GetConVar("hl2cr_vortex_chance"):GetInt() 
end

function SetUpVortex()
    if not vortex_map_pos[game.GetMap()] then return end
    if not ShouldSpawnVortex() then return end

    --VortexBall = ents.Create("prop_dynamic")
	VortexBall = ents.Create("prop_dynamic")
    --VortexBall:SetModel("models/effects/combineball.mdl")
	VortexBall:SetModel("models/dav0r/hoverball.mdl")
	
	VortexBall:SetMaterial( "Models/effects/comball_sphere")
	
    VortexBall:SetPos(vortex_map_pos[game.GetMap()][math.random(1, #vortex_map_pos[game.GetMap()])])
    VortexBall:Spawn()

	VortexBall:StartLoopingSound( "weapons/physcannon/superphys_hold_loop.wav" )
	
    local trigger = ents.Create("trigger_vortex")
    trigger:SetParent(VortexBall)
    trigger.Min, trigger.Max = VortexBall:GetCollisionBounds()
    trigger:SetCollisionBoundsWS(trigger:WorldToLocal(trigger.Min), trigger:WorldToLocal(trigger.Max))
    trigger:SetPos(VortexBall:GetPos())
    trigger.Vortex = VortexBall
    trigger:Spawn()

end

